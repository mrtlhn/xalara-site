<!doctype html>
<html lang="en">
<head>
  <!-- Schema for search engines -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Project",
    "name": "Xalara (XALRA)",
    "description": "ERC‚Äë20 token funding open biotech & longevity tooling with AI‚Äëassisted research bounties and community grants.",
    "url": "https://xalara.io/",
    "logo": "https://xalara.io/assets/xalara-256.png",
    "sameAs": [
      "https://twitter.com/Xalara_Token",
      "https://etherscan.io/token/0x20F58aC708D2ebBA5f4B6f1687073f631714f9F3",
      "https://app.uniswap.org/#/swap?inputCurrency=ETH&outputCurrency=0x20F58aC708D2ebBA5f4B6f1687073f631714f9F3&chain=ethereum",
      "https://t.me/Xalara_Community",
      "https://t.me/Xalara_Token"
    ]
  }
  </script>

  <meta charset="utf-8" />
  <title>Xalara (XALRA) ‚Äî Official Site</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Xalara (XALRA) ‚Äî ERC‚Äë20 token for open biotech & longevity tooling, with AI‚Äëassisted research bounties and community grants." />
  <link rel="canonical" href="https://xalara.io/" />
  <meta name="robots" content="index,follow">

  <!-- Open Graph / Twitter -->
  <meta property="og:title" content="Xalara (XALRA)" />
  <meta property="og:description" content="Open biotech ‚Ä¢ Longevity ‚Ä¢ AI‚Äëassisted research. Contract, links, liquidity, and community roadmap." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://xalara.io/" />
  <meta property="og:site_name" content="Xalara" />
  <meta property="og:image" content="https://xalara.io/assets/xalara-256.png?v=2">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://xalara.io/assets/xalara-256.png?v=2">

  <!-- Identity / SEO helpers -->
  <meta name="theme-color" content="#0b0d12">
  <meta name="keywords" content="Xalara, XALRA, longevity, biotech, bioinformatics, AI, ERC-20, Ethereum">

  <!-- Favicons / app icons -->
  <link rel="icon" type="image/png" sizes="32x32"  href="/assets/xalara-32.png?v=2">
  <link rel="icon" type="image/png" sizes="192x192" href="/assets/xalara-256.png?v=2">
  <link rel="apple-touch-icon"                 href="/assets/xalara-256.png?v=2">

  <!-- Optional: advertise your tokenlist.json to tooling -->
  <!-- <link rel="alternate" type="application/json" href="/tokenlist.json"> -->

  <style>
    .topnav { margin-top: 6px; font-size: 14px; }

    :root {
      --bg:#0b0d12; --card:#111826; --text:#e7edf5; --muted:#9fb0c5;
      --accent:#6ee7ff; --accent2:#a78bfa; --ok:#a7f3d0; --warn:#ffd166;
      --line:#1b2535;
    }
    * { box-sizing: border-box; }
    body {
      margin:0; color:var(--text);
      font:16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial;
      background: radial-gradient(1200px 600px at 80% -10%, #1b2131 0%, #0b0d12 60%);
    }
    /* subtle lab grid overlay */
    body::before {
      content:""; position:fixed; inset:0; pointer-events:none; z-index:-1;
      background:
        repeating-linear-gradient(90deg, rgba(255,255,255,.03) 0 1px, transparent 1px 120px),
       .repeating-linear-gradient(0deg,  rgba(255,255,255,.02) 0 1px, transparent 1px 120px);
      mask-image: radial-gradient(1200px 600px at 80% -10%, rgba(0,0,0,.6) 0, rgba(0,0,0,1) 60%);
    }
    .wrap { max-width: 980px; margin: 0 auto; padding: 24px; }
    header { padding: 24px 0 8px; }
    nav { display:flex; gap:12px; margin-top:8px; }
    nav a { color:#bcd1f0; font-size:14px; opacity:.9 }
    nav a:hover { opacity:1; }
    h1 { margin:0 0 6px; font-size: clamp(28px, 4vw, 40px); letter-spacing:.2px; }
    h2 {
      margin: 0 0 12px; font-size: clamp(20px, 2.5vw, 24px);
      position: relative; padding-left: 10px;
    }
    h2::before {
      content:""; position:absolute; left:0; top:6px; bottom:6px; width:4px;
      background: linear-gradient(180deg, var(--accent), var(--accent2));
      border-radius: 999px;
    }
    .subtitle { color:var(--muted); margin:0 0 18px; }
    .card {
      background:var(--card); border:1px solid var(--line); border-radius:14px;
      padding:18px; margin:16px 0; box-shadow: 0 10px 28px rgba(0,0,0,.35);
    }
    .grid { display:grid; gap:16px; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); }
    .kpis { display:grid; gap:12px; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); }
    .kpi {
      background:#0f1725; border:1px solid #1a2436; border-radius:12px; padding:12px;
    }
    .kpi .label { color:var(--muted); font-size:12px; text-transform: uppercase; letter-spacing:.08em; }
    .kpi .value { font-weight:700; font-size:18px; margin-top:4px; }
    code { background:#0e1320; border:1px solid #1b2233; padding:4px 8px; border-radius:8px;
           font-family: ui-monospace,SFMono-Regular,Menlo,Consolas,"Liberation Mono",monospace; color:#cfe1ff; word-break: break-all; }
    button { cursor: pointer; border:1px solid #2a3550; background:#141a29; color:#eaf2ff; padding:10px 14px; border-radius:10px; font-weight:600; transition:.15s ease; }
    button:hover { border-color:#3b4670; transform: translateY(-1px); }
    .btn-row { display:flex; flex-wrap:wrap; gap:10px; margin-top:10px; }
    .tag { display:inline-flex; align-items:center; gap:8px; padding:4px 10px; border-radius:999px; background:#0e1320; border:1px solid #1b2233; color:#cde0ff; font-size:13px; }
    .muted { color: var(--muted); }
    .warn  { color:var(--warn); }
    .ok    { color:var(--ok); }
    footer { color: var(--muted); font-size: 13px; padding: 18px 6px 36px; }
    a { color: #84c5ff; text-decoration: none; }
    a:hover { text-decoration: underline; }
    ul.clean { margin:0; padding-left:18px; }
    .phase li { margin:6px 0; }
    .chip { display:inline-block; padding:2px 8px; border:1px solid #22304a; border-radius:999px; background:#0e1524; font-size:12px; color:#bcd1f0; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>
        <img src="/assets/xalara-256.png?v=2" alt="XALARA"
             style="height:40px; vertical-align:middle; border-radius:8px; margin-right:8px">
        Xalara <span class="muted">(XALRA)</span>
      </h1>
      <p class="subtitle">Open Biotech ‚Ä¢ Longevity ‚Ä¢ AI‚Äëassisted research ¬∑ ERC‚Äë20 on <strong>Ethereum</strong></p>

      <nav class="topnav">
        <a href="/about.html">About</a> ¬∑
        <a href="/press.html">Press</a> ¬∑
        <a href="/assets/xalara-whitepaper-v1.pdf" target="_blank" rel="noopener">Whitepaper (PDF)</a> ¬∑
        <a href="https://app.uniswap.org/#/swap?inputCurrency=ETH&outputCurrency=0x20F58aC708D2ebBA5f4B6f1687073f631714f9F3&chain=ethereum" target="_blank" rel="noopener">Uniswap</a> ¬∑
        <a href="https://twitter.com/Xalara_Token" target="_blank" rel="noopener">X (Twitter)</a> ¬∑
        <a href="https://t.me/Xalara_Community" target="_blank" rel="noopener">Telegram</a>
      </nav>

      <div id="networkNote" class="tag" style="margin-top:8px">Checking wallet network‚Ä¶</div>
    </header>

    <!-- Contract -->
    <section id="contract" class="card">
      <h2>Contract</h2>
      <div class="kpis">
        <div class="kpi">
          <div class="label">Mainnet address</div>
          <div class="value"><code id="addr">0x20F58aC708D2ebBA5f4B6f1687073f631714f9F3</code></div>
        </div>
        <div class="kpi">
          <div class="label">Owner (Safe)</div>
          <div class="value"><code>0x5aBB817aaE8C17fBc97D2E2b4f08B35457aA1405</code></div>
        </div>
        <div class="kpi">
          <div class="label">Total supply</div>
          <div class="value">1,000,000,000 XALRA</div>
        </div>
      </div>
      <div class="btn-row">
        <button id="copy">Copy address</button>
        <a id="etherscan" class="tag" href="https://etherscan.io/address/0x20F58aC708D2ebBA5f4B6f1687073f631714f9F3#code" target="_blank" rel="noopener">View on Etherscan ‚Üó</a>
        <button id="add">Add XALRA to MetaMask</button>
      </div>
      <p class="muted" style="margin-top:10px">Standard: ERC‚Äë20 ¬∑ Features: Burnable ¬∑ Pausable ¬∑ EIP‚Äë2612 Permit ¬∑ 18 decimals</p>
    </section>

    <!-- Mission & Focus Areas -->
    <section class="card">
      <h2>Mission & Focus Areas</h2>
      <p class="muted">Xalara funds open tools and small grants at the intersection of <strong>biotechnology</strong>, <strong>longevity</strong>, and <strong>AI</strong>. We prioritize transparent, reproducible work.</p>
      <div class="grid">
        <div>
          <p>üß¨ <strong>Longevity R&D</strong><br>
          Community‚Äëdriven experiments and datasets for healthspan ‚Äî from assay curation to biomarker exploration.</p>
        </div>
        <div>
          <p>ü§ñ <strong>AI for Bioinformatics</strong><br>
          Lightweight pipelines to help non‚Äëexperts run analyses, with reproducible notebooks and synthetic data where needed.</p>
        </div>
        <div>
          <p>ü§ù <strong>Open Grants & Bounties</strong><br>
          Micro‚Äëgrants for useful tools (data cleaning, viz, literature triage) and reproducibility rewards.</p>
        </div>
      </div>
    </section>

    <!-- Supply (from API) -->
    <section class="card" id="supplyCard">
      <h2>Supply</h2>
      <div class="kpis">
        <div class="kpi"><div class="label">Circulating</div><div class="value" id="circNow">‚Äî</div></div>
        <div class="kpi"><div class="label">Excluded (Safe)</div><div class="value" id="exSafe">‚Äî</div></div>
        <div class="kpi"><div class="label">Excluded (Deployer)</div><div class="value" id="exEoa">‚Äî</div></div>
      </div>
      <p class="muted" style="margin-top:6px">Source: <code>/api/circulating</code></p>
    </section>

    <!-- Liquidity status -->
    <section class="card" id="liqCard">
      <h2>Liquidity</h2>
      <p class="muted">
        Status: <strong id="liqStatus">Unlocked</strong>
        ¬∑ Plan: lock/burn on <span id="liqDate">TBD</span><br>
        Pair: <a id="pairLink" href="https://etherscan.io/address/0x87D0F6e909C459B1dA253F1A9570cceC8F59Bb91" target="_blank" rel="noopener">Etherscan ‚Üó</a>
        ¬∑ LP in Safe: <a id="lpHoldLink" href="https://etherscan.io/token/0x87D0F6e909C459B1dA253F1A9570cceC8F59Bb91?a=0x5aBB817aaE8C17fBc97D2E2b4f08B35457aA1405" target="_blank" rel="noopener">view balance ‚Üó</a>
      </p>
      <p class="muted" style="margin-top:6px">
        We‚Äôll announce the exact time window ‚â•24h in advance and post a proof link here and on X after the action.
      </p>
    </section>

    <!-- Pool snapshot (reads from API) -->
    <section class="card" id="pool">
      <h2>Pool Snapshot (Uniswap v2)</h2>
      <div class="kpis">
        <div class="kpi"><div class="label">Reserve (XALRA)</div><div class="value" id="resXalra">‚Äî</div></div>
        <div class="kpi"><div class="label">Reserve (ETH)</div><div class="value" id="resEth">‚Äî</div></div>
        <div class="kpi"><div class="label">Mid price</div><div class="value" id="midPrice">‚Äî</div></div>
        <div class="kpi"><div class="label">LP in Safe</div><div class="value" id="lpSafe">‚Äî</div></div>
      </div>
      <p class="muted" style="margin-top:6px">Indicative; computed from pair reserves (ETH per XALRA). Not price advice.</p>
    </section>

    <!-- Provenance -->
    <section class="card">
      <h2>Provenance</h2>
      <div class="grid">
        <div>
          <ul class="clean">
            <li>Contract verified: <a href="https://etherscan.io/address/0x20F58aC708D2ebBA5f4B6f1687073f631714f9F3#code" target="_blank" rel="noopener">Etherscan</a></li>
            <li>Liquidity pair: <code>0x87D0F6e909C459B1dA253F1A9570cceC8F59Bb91</code></li>
            <li>Router: <code>UniswapV2Router02</code></li>
          </ul>
        </div>
        <div>
          <ul class="clean">
            <li>Owner (mainnet): Safe multisig <code>0x5aBB‚Ä¶1405</code></li>
            <li>No transfer taxes; fixed supply at deploy</li>
            <li>Open data ethos; reproducible notebooks</li>
          </ul>
        </div>
      </div>
      <p class="muted" style="margin-top:8px"><strong>Note:</strong> XALRA is not an investment and makes no promises of returns or medical outcomes.</p>
    </section>

    <!-- Roadmap & Community targets -->
    <section class="card" id="roadmap">
      <h2>Roadmap & Community Targets</h2>
      <ul class="phase">
        <li>‚úÖ <strong>Phase 0</strong>: Deploy, verify, Safe owner, initial Uniswap v2 pool.</li>
        <li>üß™ <strong>Phase 1</strong> ‚Äî <span class="chip">100 X followers</span> or <span class="chip">50 holders</span>:
          publish a 4‚Äëpage litepaper + first demo notebook.</li>
        <li>üî≠ <strong>Phase 2</strong> ‚Äî <span class="chip">250 X followers</span> or <span class="chip">150 holders</span>:
          open first micro‚Äëgrants (tooling / data curation); announce LP lock schedule.</li>
        <li>üß¨ <strong>Phase 3</strong> ‚Äî <span class="chip">500 X followers</span> or <span class="chip">300 holders</span>:
          lock a portion of LP (eg. 3 months) and ship two reproducible examples.</li>
        <li>üåê <strong>Phase 4</strong> ‚Äî <span class="chip">1k X followers</span> or <span class="chip">500 holders</span>:
          scale grants; community voting on the next research bounties.</li>
      </ul>
      <p class="muted" style="margin-top:8px">Targets are directional; timing subject to gas & operational constraints. We‚Äôll announce each step publicly with links and proofs.</p>
    </section>

    <!-- Grants & Bounties -->
    <section class="card" id="grants">
      <h2>Grants & Bounties</h2>
      <p>We prioritize useful, reproducible outputs over speculation. Examples:</p>
      <ul class="clean">
        <li>üõ†Ô∏è A script to normalize publicly available aging biomarker datasets</li>
        <li>üìä A compact dashboard rendering key pool/holder on‚Äëchain stats</li>
        <li>üß† A tutorial notebook comparing 2‚Äì3 ML methods on a longevity dataset</li>
      </ul>
      <p class="muted" style="margin-top:8px">
        Propose a bounty or apply:
        <a href="mailto:xalara.project@gmail.com">xalara.project@gmail.com</a> ¬∑
        <a href="https://twitter.com/Xalara_Token" target="_blank" rel="noopener">Twitter</a> ¬∑
        <a href="https://t.me/Xalara_Community" target="_blank" rel="noopener">Telegram</a>
      </p>
    </section>

    <!-- How to Buy (Mainnet) -->
    <section class="card" id="howto">
      <h2>How to buy XALRA</h2>
      <ol style="margin:0; padding-left:18px">
        <li>Open <a id="buyUniswap" target="_blank" rel="noopener">Uniswap on Ethereum</a>.</li>
        <li>In the token selector, paste the XALRA address:
          <code>0x20F58aC708D2ebBA5f4B6f1687073f631714f9F3</code>.
        </li>
        <li>Select <strong>ETH ‚Üí XALRA</strong>, set slippage to <strong>0.5‚Äì1%</strong>, and swap.</li>
      </ol>
      <p class="muted" style="margin-top:10px">
        Tip: If Uniswap shows ‚ÄúUnknown token‚Äù, click ‚ÄúImport‚Äù (normal for new tokens).
        Always verify the contract address.
      </p>
    </section>

    <!-- Trade (Mainnet) -->
    <section class="card" id="trade">
      <h2>Trade</h2>
      <p class="muted">Mainnet links for convenience.</p>
      <ul style="margin:0; padding-left:18px">
        <li><a id="swapLink"   target="_blank" rel="noopener">Swap ETH ‚Üí XALRA on Uniswap ‚Üó</a></li>
        <li><a id="addLiqLink" target="_blank" rel="noopener">Add liquidity (ETH + XALRA) ‚Üó</a></li>
        <li><a id="pairInfoLink" target="_blank" rel="noopener">View pool on a DEX tracker ‚Üó</a></li>
      </ul>
    </section>

    <!-- Balances (read-only via wallet provider) -->
    <section class="card" id="balancesCard">
      <h2>Balances</h2>
      <p class="muted">
        Read‚Äëonly via your wallet provider. Enter addresses (one per line or separated by commas),
        then click <strong>Refresh</strong>. Your connected wallet (if any) will be added automatically.
      </p>

      <textarea id="addrList" rows="4" style="width:100%; background:#0e1320; color:#cfe1ff;
        border:1px solid #1b2233; border-radius:8px; padding:8px;"></textarea>

      <div class="btn-row">
        <button id="refreshBalances">Refresh</button>
        <button id="clearBalances" style="opacity:.85">Clear</button>
      </div>

      <div id="balancesList" style="margin-top:8px"></div>
      <p class="muted">Total (listed): <strong id="balancesTotal">‚Äì</strong> XALRA</p>
    </section>

    <footer>
      ¬© <span id="year"></span> Xalara ¬∑ Network: <span id="footerNet">‚Äî</span><br>
      <a href="https://twitter.com/Xalara_Token" target="_blank" rel="noopener">Twitter</a> ¬∑
      <a href="https://t.me/Xalara_Community" target="_blank" rel="noopener">Telegram</a> ¬∑
      <a href="mailto:xalara.project@gmail.com">Email</a> ¬∑
      <a href="https://etherscan.io/address/0x20F58aC708D2ebBA5f4B6f1687073f631714f9F3#code" target="_blank" rel="noopener">Etherscan</a>
      <p class="muted" style="margin-top:8px">
        Security: owner is a Safe multisig (<code>0x5aBB‚Ä¶1405</code>); liquidity currently <strong>unlocked</strong>.
        We plan to <strong>lock or burn</strong> LP at the first community milestone and post the proof link here and on X.
      </p>
    </footer>
  </div>

  <!-- ethers.js (needed for the Balances panel only) -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.13.2/dist/ethers.umd.min.js" crossorigin="anonymous"></script>

  <!-- App logic -->
  <script>
  (function () {
    // === MAINNET CONSTANTS ===
    const MAINNET_TOKEN = "0x20F58aC708D2ebBA5f4B6f1687073f631714f9F3";
    const MAINNET_PAIR  = "0x87D0F6e909C459B1dA253F1A9570cceC8F59Bb91";
    const SAFE_ADDR     = "0x5aBB817aaE8C17fBc97D2E2b4f08B35457aA1405";

    // Optional: if you later lock/burn LP, put proof here to flip the badge
    const PLANNED_LIQ_ACTION_DATE = "";  // e.g., "2025-03-01"
    const LP_BURN_TX = "";               // e.g., "0xabc..."
    const LP_LOCK_PROOF_URL = "";        // e.g., "https://app.unicrypt.network/lock/..."

    // Helpers
    const $ = (id) => document.getElementById(id);
    const fmt = (n, max=6) => Number(n).toLocaleString(undefined, { maximumFractionDigits: max });

    function setNetworkBadge() {
      const badge = $("networkNote");
      const footerNet = $("footerNet");
      if (!window.ethereum) {
        if (badge) badge.textContent = "Wallet not detected (showing mainnet data)";
        if (footerNet) footerNet.textContent = "Ethereum Mainnet";
        return;
      }
      window.ethereum.request({ method: "eth_chainId" })
        .then(idHex => {
          const isMainnet = idHex === "0x1";
          if (badge) badge.textContent = isMainnet
            ? "Wallet network: Ethereum Mainnet ‚úì"
            : `Wallet network: ${parseInt(idHex,16)} (not mainnet) ‚Äî site shows mainnet data`;
          if (footerNet) footerNet.textContent = isMainnet ? "Ethereum Mainnet" : "Other";
        })
        .catch(() => {
          if (badge) badge.textContent = "Wallet network: unknown";
          if (footerNet) footerNet.textContent = "Ethereum";
        });
    }

    function updateTradeLinks() {
      const buyUniswap   = $("buyUniswap");
      const swapLink     = $("swapLink");
      const addLiqLink   = $("addLiqLink");
      const pairInfoLink = $("pairInfoLink");

      const swapUrl = `https://app.uniswap.org/#/swap?inputCurrency=ETH&outputCurrency=${MAINNET_TOKEN}&chain=ethereum`;
      const addUrl  = `https://app.uniswap.org/#/add/v2/ETH/${MAINNET_TOKEN}?chain=ethereum`;

      if (buyUniswap) buyUniswap.href = swapUrl;
      if (swapLink)   swapLink.href   = swapUrl;
      if (addLiqLink) addLiqLink.href = addUrl;
      if (pairInfoLink) pairInfoLink.href = `https://dexscreener.com/ethereum/${MAINNET_PAIR}`;
    }

    function wireLiquiditySection() {
      const statusEl = $("liqStatus");
      const dateEl   = $("liqDate");
      if (dateEl) dateEl.textContent = PLANNED_LIQ_ACTION_DATE || "TBD";

      if (statusEl) {
        if (LP_BURN_TX) {
          statusEl.innerHTML = `Locked (burn) ¬∑ <a href="https://etherscan.io/tx/${LP_BURN_TX}" target="_blank" rel="noopener">proof ‚Üó</a>`;
        } else if (LP_LOCK_PROOF_URL) {
          statusEl.innerHTML = `Locked (locker) ¬∑ <a href="${LP_LOCK_PROOF_URL}" target="_blank" rel="noopener">proof ‚Üó</a>`;
        } else {
          statusEl.textContent = "Unlocked";
        }
      }
    }

    // --- API readers (server-side endpoints) ---
    async function updateSupply() {
      try {
        const r = await fetch("/api/circulating?format=human");
        if (!r.ok) throw new Error("HTTP " + r.status);
        const j = await r.json();
        $("circNow").textContent = fmt(j.circulating, 6);
        $("exSafe").textContent  = fmt(j.excluded.safe.balance, 6);
        $("exEoa").textContent   = fmt(j.excluded.deployer.balance, 6);
      } catch (e) {
        console.warn("Supply fetch failed:", e);
        ["circNow","exSafe","exEoa"].forEach(id => { const el = $(id); if (el) el.textContent = "‚Äî"; });
      }
    }

    async function updatePoolSnapshot() {
      try {
        const r = await fetch("/api/pool?format=human");
        if (!r.ok) throw new Error("HTTP " + r.status);
        const j = await r.json();
        $("resXalra").textContent = fmt(j.reserveXalara);
        $("resEth").textContent   = fmt(j.reserveEth);
        $("midPrice").textContent = `${Number(j.priceEthPerXalara).toPrecision(6)} ETH / XALRA`;
        $("lpSafe").textContent   = `${j.lp.safe} / ${j.lp.total}`;
      } catch (e) {
        console.warn("Pool snapshot failed:", e);
        ["resXalra","resEth","midPrice","lpSafe"].forEach(id => { const el = $(id); if (el) el.textContent = "‚Äî"; });
      }
    }

    // Contract card buttons
    function wireBasicButtons() {
      $("copy")?.addEventListener("click", async () => {
        try {
          await navigator.clipboard.writeText(MAINNET_TOKEN);
          const btn = $("copy"); const old = btn.textContent; btn.textContent = "Copied!"; setTimeout(() => btn.textContent = old, 1200);
        } catch {}
      });
      $("add")?.addEventListener("click", async () => {
        if (!window.ethereum) return alert("MetaMask not detected.");
        try {
          await window.ethereum.request({
            method: "wallet_watchAsset",
            params: { type: "ERC20", options: { address: MAINNET_TOKEN, symbol: "XALRA", decimals: 18 } }
          });
        } catch (e) { alert(e?.message || String(e)); }
      });
    }

    // --- Optional: Balances panel (uses wallet provider) ---
    function wireBalancesPanel() {
      const addrBox   = $("addrList");
      const listEl    = $("balancesList");
      const totalEl   = $("balancesTotal");
      const btnRef    = $("refreshBalances");
      const btnClear  = $("clearBalances");
      if (!addrBox || !listEl || !totalEl || !btnRef) return;

      const TOKEN_ABI = ["function balanceOf(address) view returns (uint256)"];
      const dedupe = (arr) => Array.from(new Set(arr.map(a => a.toLowerCase())));
      const parseAddrs = (text) =>
        (text || "")
          .split(/[\s,;]+/g)
          .map(s => s.trim())
          .filter(Boolean)
          .filter(ethers.isAddress);

      function row(addr, text, isErr) {
        const r = document.createElement("div");
        r.style.cssText = "display:flex;justify-content:space-between;align-items:center;padding:6px 0;border-bottom:1px solid #1f2737;";
        const left = document.createElement("code"); left.textContent = addr;
        const right = document.createElement("strong"); right.textContent = text;
        if (isErr) right.style.color = "#ffd166";
        r.append(left, right);
        listEl.appendChild(r);
      }

      async function refresh() {
        try {
          if (!window.ethereum) { listEl.innerHTML = ""; row("-", "Wallet not detected", true); totalEl.textContent = "‚Äì"; return; }
          const provider = new ethers.BrowserProvider(window.ethereum);
          const tokenRO  = new ethers.Contract(MAINNET_TOKEN, TOKEN_ABI, provider);

          const inputAddrs = dedupe(parseAddrs(addrBox.value));
          if (inputAddrs.length === 0) { listEl.innerHTML = ""; row("-", "No valid addresses", true); totalEl.textContent = "‚Äì"; return; }

          listEl.innerHTML = "";
          let total = 0n;
          const results = await Promise.allSettled(inputAddrs.map(a => tokenRO.balanceOf(a)));
          results.forEach((res, i) => {
            const addr = inputAddrs[i];
            if (res.status === "fulfilled") {
              const bal = res.value;
              total += bal;
              row(addr, ethers.formatUnits(bal, 18), false);
            } else {
              row(addr, "Error", true);
            }
          });
          totalEl.textContent = ethers.formatUnits(total, 18);
        } catch (e) {
          listEl.innerHTML = ""; row("-", (e?.message || String(e)), true); totalEl.textContent = "‚Äì";
        }
      }

      async function addConnectedOnce() {
        try {
          if (!window.ethereum) return;
          const accounts = await window.ethereum.request({ method: "eth_accounts" });
          const me = (accounts[0] || "").toLowerCase();
          if (ethers.isAddress(me)) {
            const current = dedupe(parseAddrs(addrBox.value));
            if (!current.includes(me)) {
              addrBox.value = (addrBox.value.trim() + "\n" + me).trim() + "\n";
            }
          }
        } catch {}
      }

      btnRef.addEventListener("click", refresh);
      btnClear?.addEventListener("click", () => { addrBox.value = ""; listEl.innerHTML = ""; totalEl.textContent = "‚Äì"; });

      if (window.ethereum?.on) {
        window.ethereum.on("accountsChanged", async () => { await addConnectedOnce(); await refresh(); });
        window.ethereum.on("chainChanged",    async () => { setNetworkBadge(); await refresh(); });
      }

      addConnectedOnce().then(refresh);
    }

    function onLoad() {
      // small helpers
      const y = $("year"); if (y) y.textContent = new Date().getFullYear();
      setNetworkBadge();
      updateTradeLinks();
      wireLiquiditySection();
      wireBasicButtons();

      // API-driven sections
      updateSupply();
      updatePoolSnapshot();
      setInterval(updateSupply,       60_000); // refresh every minute
      setInterval(updatePoolSnapshot, 60_000);

      // Optional balances panel
      wireBalancesPanel();
    }

    // kick off
    window.addEventListener("load", onLoad);
  })();
  </script>
</body>
</html>



